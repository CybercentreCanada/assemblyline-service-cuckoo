name: Cuckoo
version: 1
description: Provides dynamic malware analysis through sandboxing.

accepts: (archive|executable/windows|java|audiovisual|meta)/.*|unknown|document/installer/windows|document/office/excel|document/office/ole|document/office/powerpoint|document/office/rtf|document/office/unknown|document/office/word|document/pdf|document/email|executable/linux/elf*|code/javascript|code/jscript|code/python|code/vbs|code/wsf
rejects: empty|metadata/.*

stage: CORE
category: Dynamic Analysis

file_required: true
timeout: 300
disable_cache: false

enabled: false
is_external: false
licence_count: 0

config:
  # Cuckoo host specifications
  remote_host_ip: 127.0.0.1
  remote_host_port: 8090
  auth_header_value: Bearer sample_api_token

  # Cuckoo analysis specifications
  analysis_timeout: 120
  enforce_timeout: false
  generate_report: true
  dump_processes: false
  arguments:
  custom_options:
  dump_memory: false
  no_monitor: false
  routing: inetsim # TODO: implement routing options
  dedup_similar_percent: 80
  max_dll_exports_exec: 5
  dll_function:
  platform:
  clock:  # format %m-%d-%Y %H:%H:%S

  # Cuckoo request specification
  max_file_size: 80000000
  recursion_limit: 10000

  # InetSim specifications
  random_ip_range: 11.0.0.0/8

heuristics:
  - heur_id: 1
    attack_id: # one of ['T1012', 'T1082']
    name: Exploit
    score: 1000
    filetype: '*'
    description: Exploits an known software vulnerability or security flaw.

  - heur_id: 2
    attack_id: # one of ['T1086', 'T1197', 'T1071', 'T1112']
    name: PowerShell
    score: 1000
    filetype: '*'
    description: Leverages Powershell to attack Windows operating systems.

  - heur_id: 3
    attack_id: T1086
    name: Hacking tool
    score: 2000
    filetype: '*'
    description: Programs designed to crack or break computer and network security measures.

  - heur_id: 4
    attack_id: T1112
    name: Locker
    score: 500
    filetype: '*'
    description: Prevents access to system data and files.

  - heur_id: 5
    attack_id: T1063
    name: Anti-analysis
    score: 1000
    filetype: '*'
    description: Constructed to conceal or obfuscate itself to prevent analysis.

  - heur_id: 6
    name: Suspicious PDF API
    score: 500
    filetype: '*'
    description: Makes API calls not consistent with expected/standard behaviour.

  - heur_id: 7
    name: Suspicious Android API
    score: 1000
    filetype: '*'
    description: Makes API calls not consistent with expected/standard behaviour.

  - heur_id: 8
    attack_id: # one of ['T1089', 'T1031', 'T1012', 'T1112', 'T1063']
    name: Anti-antivirus
    score: 1000
    filetype: '*'
    description: Attempts to conceal itself from detection by anti-virus.

  - heur_id: 9
    attack_id: # one of ['T1012', 'T1057', 'T1047', 'T1083', 'T1007', 'T1082']
    name: Anti-vm
    score: 1000
    filetype: '*'
    description: Attempts to detect if it is being run in virtualized environment.

  - heur_id: 10
    attack_id: # one of ['T1057', 'T1083']
    name: Anti-debug
    score: 500
    filetype: '*'
    description: Attempts to detect if it is being debugged.

  - heur_id: 11
    name: Worm
    score: 1000
    filetype: '*'
    description: Attempts to replicate itself in order to spread to other systems.

  - heur_id: 12
    name: Cloud
    score: 500
    filetype: '*'
    description: Makes connection to cloud service.

  - heur_id: 13
    name: Virus
    score: 1000
    filetype: '*'
    description: Malicious software program

  - heur_id: 14
    attack_id: # one of ['T1203', 'T1179', 'T1071']
    name: Suspicious Office
    score: 500
    filetype: '*'
    description: Makes API calls not consistent with expected/standard behaviour

  - heur_id: 15
    attack_id: # one of ['T1047', 'T1112']
    name: Ransomware
    score: 1000
    filetype: '*'
    description: Designed to block access to a system until a sum of money is paid.

  - heur_id: 16
    attack_id: # one of ['T1067', 'T1031', 'T1103', 'T1060', 'T1098', 'T1204', 'T1112', 'T1096', 'T1070', 'T1053', 'T1047', 'T1059', 'T1136', 'T1023', 'T1129']
    name: Persistence
    score: 1000
    filetype: '*'
    description: Technique used to maintain presence in system(s) across interruptions that could cut off access.

  - heur_id: 17
    attack_id: # one of ['T1086', 'T1055', 'T1057', 'T1071']
    name: Injection
    score: 1000
    filetype: '*'
    description: Input is not properly validated and gets processed by an interpreter as part of a command or query.

  - heur_id: 18
    name: Dropper
    score: 500
    filetype: '*'
    description: Trojan that drops additional malware on an affected system.

  - heur_id: 19
    attack_id: # one of ['T1197', 'T1059', 'T1053']
    name: Suspicious Execution Chain
    score: 1000
    filetype: '*'
    description: Command shell or script process was created by unexpected parent process.

  - heur_id: 20
    attack_id: T1070
    name: Trojan
    score: 1000
    filetype: '*'
    description: Presents itself as legitimate in attempt to infiltrate a system.

  - heur_id: 21
    name: RAT
    score: 1000
    filetype: '*'
    description: Designed to provide the capability of covert surveillance and/or unauthorized access to a target.

  - heur_id: 22
    attack_id: T1071
    name: C2
    score: 1000
    filetype: '*'
    description: Communicates with a server controlled by a malicious actor.

  - heur_id: 23
    attack_id: T1188
    name: Tor
    score: 1000
    filetype: '*'
    description: Intalls/Leverages Tor to enable anonymous communication.

  - heur_id: 24
    name: Web Mail
    score: 500
    filetype: '*'
    description: Connects to smtp.[domain] for possible spamming or data exfiltration.

  - heur_id: 25
    attack_id: # one of ['T1089', 'T1057', 'T1083', 'T1115', 'T1082']
    name: Anti-sandbox
    score: 1000
    filetype: '*'
    description: Attempts to detect if it is in a sandbox.

  - heur_id: 26
    attack_id: # one of ['T1089', 'T1031', 'T1036', 'T1112', 'T1071', 'T1088', 'T1096', 'T1158', 'T1070', 'T1054', 'T1143', 'T1222']
    name: Stealth
    score: 1000
    filetype: '*'
    description: Leverages/modifies internal processes and settings to conceal itself.

  - heur_id: 27
    attack_id: T1045
    name: Packer
    score: 500
    filetype: '*'
    description: Compresses, encrypts, and/or modifies a malicious file's format.

  - heur_id: 28
    name: Banker
    score: 1000
    filetype: '*'
    description: Designed to gain access to confidential information stored or processed through online banking.

  - heur_id: 29
    name: Point-of-sale
    score: 1000
    filetype: '*'
    description: Steals information related to financial transactions, including credit card information.

  - heur_id: 30
    attack_id: # one of ['T1086', 'T1031', 'T1117', 'T1089']
    name: Bypass
    score: 1000
    filetype: '*'
    description: Attempts to bypass operating systems security controls (firewall, amsi, applocker, etc.)

  - heur_id: 31
    name: Crash
    score: 100
    filetype: '*'
    description: Attempts to crash the system.

  - heur_id: 32
    name: IM
    score: 500
    filetype: '*'
    description: Leverages instant-messaging.

  - heur_id: 33
    attack_id: T1067
    name: Rootkit
    score: 1000
    filetype: '*'
    description: Designed to provide continued privileged access to a system while actively hiding its presence.

  - heur_id: 34
    name: Adware
    score: 500
    filetype: '*'
    description: Displays unwanted, unsolicited advertisements.

  - heur_id: 35
    attack_id: # one of ['T1003', 'T1089', 'T1005', 'T1112', 'T1040', 'T1115', 'T1081']
    name: Infostealer
    score: 1000
    filetype: '*'
    description: Collects and disseminates information such as login details, usernames, passwords, etc.

  - heur_id: 36
    attack_id: T1047
    name: WMI
    score: 1000
    filetype: '*'
    description: Leverages Windows Management Instrumentation (WMI) to gather information and/or execute a process.

  - heur_id: 37
    attack_id: # one of ['T1129', 'T1071'}]
    name: Downloader
    score: 1000
    filetype: '*'
    description: Trojan that downloads / installs files.

  - heur_id: 38
    name: DynDNS
    score: 500
    filetype: '*'
    description: Utilizes dynamic DNS.

  - heur_id: 39
    name: BOT
    score: 1000
    filetype: '*'
    description: Appears to be a bot or exhibits bot-like behaviour.

  - heur_id: 40
    name: Rop
    score: 1000
    filetype: '*'
    description: Exploits trusted programs to execute malicious code from memory to evade data execution prevention.

  - heur_id: 41
    name: Fraud
    score: 1000
    filetype: '*'
    description: Presents itself as a legitimate program and/or facilitates fraudulent activity.

  - heur_id: 42
    name: URLshort
    score: 500
    filetype: '*'
    description: Leverages URL shortening to obfuscate malicious destination.

  - heur_id: 43
    attack_id: T1057
    name: Anti-emulation
    score: 1000
    filetype: '*'
    description: Detects the presence of an emulator.

  - heur_id: 44
    name: Cryptocurrency
    score: 500
    filetype: '*'
    description: Facilitates mining of cryptocurrency.

  - heur_id: 45
    name: Bind
    score: 500
    filetype: '*'
    description: Allows a resource to be sent or received across a network.

# Note: Heuristic is not currently used
  - heur_id: 998
    name: SMS Activity
    score: 500
    filetype: '*'
    description: Cuckoo detected SMS activity.

# Note: Heuristic is not currently used
  - heur_id: 999
    name: Crypto Keys
    score: 500
    filetype: '*'
    description: Cuckoo detected Crypto Keys.

  - heur_id: 1000
    name: Domain detected
    score: 1000
    filetype: '*'
    description: Cuckoo detected Domains

  - heur_id: 1001
    name: Host detected
    score: 1000
    filetype: '*'
    description: Cuckoo detected Hosts

  - heur_id: 9999
    name: Unknown
    score: 0
    filetype: '*'
    description: Unknown signature detected by Cuckoo

docker_config:
  allow_internet_access: true
  image: ${REGISTRY}cccs/assemblyline-service-cuckoo:latest
  cpu_cores: 0.5
  ram_mb: 256
